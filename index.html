<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Tetris Puzzle - Outlines & More Pieces</title>
  <style>
    .container {
      width: 900px;
      height: 600px;
      position: relative;
      margin: 20px auto;
      overflow: hidden;
      border: 2px solid #333;
      background-image: url('PP.jpg'); /* Η πλήρης εικόνα αρχικά */
      background-size: 900px 600px;
      transition: background-image 0.5s;
    }
    .tetris-piece {
      position: absolute;
      background-image: url('PP.jpg');
      background-size: 900px 600px;
      opacity: 0;
      border: 2px solid #fff;  /* Περιγράμματα στα κομμάτια */
      box-sizing: border-box;
    }
    button {
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container" id="puzzleContainer"></div>
  <button id="stopBtn">STOP</button>

  <!-- Ορισμός SVG clipPaths για τα σχήματα (διαστάσεις πολλαπλάσια του 50) -->
  <svg width="0" height="0">
    <!-- T-small: bounding box 200×150 -->
    <clipPath id="T-small">
      <polygon points="0,0 200,0 200,50 150,50 150,150 50,150 50,50 0,50"/>
    </clipPath>
    <!-- L-small: bounding box 200×150 -->
    <clipPath id="L-small">
      <polygon points="0,0 0,150 200,150 200,100 100,100 100,0"/>
    </clipPath>
    <!-- I-shape pieces ως απλά ορθογώνια -->
    <clipPath id="I-500x150">
      <rect width="500" height="150"/>
    </clipPath>
    <clipPath id="I-300x150">
      <rect width="300" height="150"/>
    </clipPath>
    <clipPath id="I-400x150">
      <rect width="400" height="150"/>
    </clipPath>
    <clipPath id="I-200x150">
      <rect width="200" height="150"/>
    </clipPath>
    <clipPath id="I-450x150">
      <rect width="450" height="150"/>
    </clipPath>
    <clipPath id="I-250x150">
      <rect width="250" height="150"/>
    </clipPath>
  </svg>

  <script>
    /* 
      Στατικό layout που καλύπτει το container 900×600, χωρισμένο σε 4 σειρές των 150px ύψους.
      Δημιουργούνται 13 κομμάτια με τα παρακάτω χαρακτηριστικά:
      
      ** Σειρά 1 (y = 0, ύψος 150px):
         - Piece A: T-small, x=0, width=200, rotation: 90°
         - Piece B: L-small, x=200, width=200, rotation: 180°
         - Piece C: I-500x150, x=400, width=500, rotation: 270°
      
      ** Σειρά 2 (y = 150):
         - Piece D: I-300x150, x=0, width=300, rotation: 0°
         - Piece E: T-small, x=300, width=200, rotation: 90°
         - Piece F: I-400x150, x=500, width=400, rotation: 270°
      
      ** Σειρά 3 (y = 300):
         - Piece G: L-small, x=0, width=200, rotation: 0°
         - Piece H: I-300x150, x=200, width=300, rotation: 90°
         - Piece I: T-small, x=500, width=200, rotation: 180°
         - Piece J: I-200x150, x=700, width=200, rotation: 270°
      
      ** Σειρά 4 (y = 450) – "κόψε" και την τελευταία σειρά σε κομμάτια:
         - Piece K: I-450x150, x=0, width=450, rotation: 0°
         - Piece L: L-small, x=450, width=200, rotation: 90°
         - Piece M: I-250x150, x=650, width=250, rotation: 180°
    */
    const STATIC_LAYOUT = [
      // Σειρά 1 (y = 0)
      { type: 'T-small',    x: 0,   y: 0,   width: 200, height: 150, rotation: 90 },
      { type: 'L-small',    x: 200, y: 0,   width: 200, height: 150, rotation: 180 },
      { type: 'I-500x150',  x: 400, y: 0,   width: 500, height: 150, rotation: 270 },
      // Σειρά 2 (y = 150)
      { type: 'I-300x150',  x: 0,   y: 150, width: 300, height: 150, rotation: 0 },
      { type: 'T-small',    x: 300, y: 150, width: 200, height: 150, rotation: 90 },
      { type: 'I-400x150',  x: 500, y: 150, width: 400, height: 150, rotation: 270 },
      // Σειρά 3 (y = 300)
      { type: 'L-small',    x: 0,   y: 300, width: 200, height: 150, rotation: 0 },
      { type: 'I-300x150',  x: 200, y: 300, width: 300, height: 150, rotation: 90 },
      { type: 'T-small',    x: 500, y: 300, width: 200, height: 150, rotation: 180 },
      { type: 'I-200x150',  x: 700, y: 300, width: 200, height: 150, rotation: 270 },
      // Σειρά 4 (y = 450)
      { type: 'I-450x150',  x: 0,   y: 450, width: 450, height: 150, rotation: 0 },
      { type: 'L-small',    x: 450, y: 450, width: 200, height: 150, rotation: 90 },
      { type: 'I-250x150',  x: 650, y: 450, width: 250, height: 150, rotation: 180 }
    ];

    let animationActive = true;
    let pieces = [];

    function initializePuzzle() {
      const container = document.getElementById('puzzleContainer');
      STATIC_LAYOUT.forEach(config => {
        const piece = document.createElement('div');
        piece.className = 'tetris-piece';
        Object.assign(piece.style, {
          width: config.width + 'px',
          height: config.height + 'px',
          left: config.x + 'px',
          top: config.y + 'px',
          clipPath: `url(#${config.type})`,
          backgroundPosition: `-${config.x}px -${config.y}px`
        });
        // Αρχική θέση: τα κομμάτια τοποθετούνται έξω από την οθόνη (πάνω) με την προκαθορισμένη περιστροφή.
        piece.style.transform = `translateY(-600px) rotate(${config.rotation}deg)`;
        container.appendChild(piece);
        pieces.push(piece);
      });
    }

    function dropPieces() {
      const container = document.getElementById('puzzleContainer');
      // Απομακρύνουμε το πλήρες background για να εμφανίζονται μόνο τα κομμάτια.
      container.style.backgroundImage = 'none';

      requestAnimationFrame(() => {
        // Ταξινομούμε τα κομμάτια κατά φθίνουσα τιμή του y (τα πιο χαμηλά πέφτουν πρώτα).
        const sortedPieces = pieces.slice().sort((a, b) => parseInt(b.style.top) - parseInt(a.style.top));
        sortedPieces.forEach((piece, index) => {
          const delay = index * 150;  // 150ms delay ανά κομμάτι
          const duration = 2 + index * 0.1; // Διάρκεια του animation
          setTimeout(() => {
            if (!animationActive) return;
            piece.style.transition = `transform ${duration}s ease, opacity ${duration}s ease`;
            piece.style.opacity = '1';
            // Κατά το animation, τα κομμάτια πέφτουν στη σωστή τους θέση και περιστρέφονται στο 0°.
            piece.style.transform = 'translateY(0) rotate(0deg)';
          }, delay);
        });
      });
    }

    function stopAnimation() {
      animationActive = false;
    }

    window.onload = () => {
      initializePuzzle();
      dropPieces();
      document.getElementById('stopBtn').addEventListener('click', stopAnimation);
    };
  </script>
</body>
</html>
