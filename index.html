<!DOCTYPE html>
<html>
<head>
    <style>
        .container {
            width: 900px;
            height: 506px;
            position: relative;
            margin: 20px auto;
            overflow: hidden;
            border: 2px solid #333;
            background: #f0f0f0;
        }

        .tetris-piece {
            position: absolute;
            background-image: url('PP.jpg');
            background-size: 900px 506px;
            transition: all 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container" id="puzzleContainer"></div>
    <button id="stopBtn">STOP</button>

    <svg width="0" height="0">
        <!-- Tetris Piece Definitions -->
        <clipPath id="I-piece">
            <rect width="100" height="25"/>
        </clipPath>
        <clipPath id="O-piece">
            <rect width="50" height="50"/>
        </clipPath>
        <clipPath id="T-piece">
            <path d="M0,0 L100,0 L100,25 L70,25 L70,50 L30,50 L30,25 L0,25 Z"/>
        </clipPath>
        <clipPath id="L-piece">
            <path d="M0,0 L75,0 L75,50 L25,50 L25,25 L0,25 Z"/>
        </clipPath>
    </svg>

    <script>
        const TETRIS_SHAPES = [
            { type: 'I', width: 100, height: 25, clip: 'I-piece' },
            { type: 'O', width: 50, height: 50, clip: 'O-piece' },
            { type: 'T', width: 100, height: 50, clip: 'T-piece' },
            { type: 'L', width: 75, height: 50, clip: 'L-piece' }
        ];

        const GRID_SIZE = 50;
        const COLS = 18;
        const ROWS = 10;
        let animationActive = true;
        let animationTimeout;

        function createPuzzle() {
            const container = document.getElementById('puzzleContainer');
            container.innerHTML = '';

            // Δημιουργία Tetris κομματιών με τυχαίες θέσεις
            for(let i = 0; i < 40; i++) { // 40 κομμάτια για πλήρη κάλυψη
                const shape = TETRIS_SHAPES[Math.floor(Math.random() * TETRIS_SHAPES.length)];
                const piece = document.createElement('div');
                piece.className = 'tetris-piece';
                
                // Ορισμός διαστάσεων και σχήματος
                piece.style.width = `${shape.width}px`;
                piece.style.height = `${shape.height}px`;
                piece.style.clipPath = `url(#${shape.clip})`;
                
                // Τυχαία αρχική θέση πάνω από τον container
                piece.style.left = `${Math.random() * 900}px`;
                piece.style.top = `${-Math.random() * 500 - 100}px`;
                
                // Τυχαία περιστροφή
                piece.style.transform = `rotate(${Math.random() * 360}deg)`;
                
                // Προσάρτηση στο container
                container.appendChild(piece);
            }
            
            startAnimationCycle();
        }

        function animatePieces() {
            const pieces = document.querySelectorAll('.tetris-piece');
            
            pieces.forEach(piece => {
                // Τελική θέση μέσα στον container
                const targetX = Math.random() * (900 - parseFloat(piece.style.width));
                const targetY = Math.random() * (506 - parseFloat(piece.style.height));
                
                // Εφέ πτώσης με περιστροφή
                piece.style.transform = `translate(${targetX}px, ${targetY}px) rotate(0deg)`;
                piece.style.backgroundPosition = `-${targetX}px -${targetY}px`;
            });

            // Ανανέωση animation μετά από παύση
            animationTimeout = setTimeout(() => {
                if(animationActive) {
                    resetPieces();
                    animationTimeout = setTimeout(animatePieces, 2000);
                }
            }, 4000);
        }

        function resetPieces() {
            const pieces = document.querySelectorAll('.tetris-piece');
            pieces.forEach(piece => {
                piece.style.transition = 'none';
                piece.style.left = `${Math.random() * 900}px`;
                piece.style.top = `${-Math.random() * 500 - 100}px`;
                piece.style.transform = `rotate(${Math.random() * 360}deg)`;
                void piece.offsetWidth; // Force reflow
                piece.style.transition = 'all 1.5s cubic-bezier(0.4, 0, 0.2, 1)';
            });
        }

        function startAnimationCycle() {
            if(animationActive) {
                animatePieces();
            }
        }

        document.getElementById('stopBtn').addEventListener('click', () => {
            animationActive = false;
            clearTimeout(animationTimeout);
        });

        window.onload = createPuzzle;
    </script>
</body>
</html>
