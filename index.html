<!DOCTYPE html>
<html>
<head>
    <style>
        .container {
            width: 900px;
            height: 506px;
            position: relative;
            margin: 20px auto;
            overflow: hidden;
            border: 2px solid #333;
            background: #f0f0f0;
        }

        .puzzle-piece {
            width: 50px;
            height: 50.6px;
            position: absolute;
            background-image: url('PP.jpg');
            background-size: 900px 506px;
            clip-path: url(#jigsawPattern);
        }

        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container" id="puzzleContainer"></div>
    <button id="stopBtn">STOP</button>

    <svg width="0" height="0">
        <clipPath id="jigsawPattern">
            <path d="M0,20 Q0,0 20,0 L30,0 Q50,10 70,0 L80,0 Q100,0 100,20 
                     L100,30 Q90,50 100,70 L100,80 Q100,100 80,100 
                     L70,100 Q50,90 30,100 L20,100 Q0,100 0,80 
                     L0,70 Q10,50 0,30 Z"/>
        </clipPath>
    </svg>

    <script>
        const COLS = 18;
        const ROWS = 10;
        const PIECE_WIDTH = 50;
        const PIECE_HEIGHT = 50.6;
        let animationActive = true;
        let animations = [];

        function createPuzzle() {
            const container = document.getElementById('puzzleContainer');
            container.innerHTML = '';

            for(let row = 0; row < ROWS; row++) {
                for(let col = 0; col < COLS; col++) {
                    const piece = document.createElement('div');
                    piece.className = 'puzzle-piece';
                    piece.style.backgroundPosition = `-${col * PIECE_WIDTH}px -${row * PIECE_HEIGHT}px`;
                    
                    // Αρχική θέση έξω από τον container
                    const startX = Math.random() * 900 - 100;
                    const startY = -100 - Math.random() * 100;
                    piece.style.transform = `translate(${startX}px, ${startY}px)`;
                    
                    container.appendChild(piece);
                    animatePiece(piece, col, row);
                }
            }
        }

        function animatePiece(piece, targetCol, targetRow) {
            if(!animationActive) return;

            const targetX = targetCol * PIECE_WIDTH;
            const targetY = targetRow * PIECE_HEIGHT;
            
            // Δημιουργία καμπύλης διαδρομής (Bezier curve)
            const path = [
                { transform: piece.style.transform }, 
                { 
                    transform: `translate(${targetX}px, ${targetY}px)`,
                    offset: 0.7,
                    easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                },
                { transform: `translate(${targetX}px, ${targetY}px) rotate(0deg)` }
            ];

            const animation = piece.animate(path, {
                duration: 2000 + Math.random() * 1000,
                delay: Math.random() * 1000,
                iterations: Infinity
            });

            animations.push(animation);
        }

        function stopAnimations() {
            animations.forEach(anim => anim.cancel());
            animations = [];
        }

        document.getElementById('stopBtn').addEventListener('click', () => {
            animationActive = false;
            stopAnimations();
        });

        window.onload = createPuzzle;
    </script>
</body>
</html>
