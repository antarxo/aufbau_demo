<!DOCTYPE html>
<html>
<head>
    <style>
        .container {
            width: 900px;
            height: 506px;
            position: relative;
            margin: 20px auto;
            overflow: hidden;
            border: 2px solid #333;
            background: #f0f0f0;
        }

        .tetris-piece {
            position: absolute;
            background-image: url('PP.jpg');
            background-size: 900px 506px;
            transition: all 1s ease-in-out;
        }

        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container" id="puzzleContainer"></div>
    <button id="stopBtn">STOP</button>

    <!-- Tetris clip-paths -->
    <svg width="0" height="0">
        <!-- I-shape (4x1) -->
        <clipPath id="I-shape">
            <rect width="200" height="50" />
        </clipPath>

        <!-- T-shape -->
        <clipPath id="T-shape">
            <path d="M0,0 L200,0 L200,50 L125,50 L125,100 L75,100 L75,50 L0,50 Z"/>
        </clipPath>

        <!-- L-shape -->
        <clipPath id="L-shape">
            <path d="M0,0 L100,0 L100,150 L50,150 L50,100 L0,100 Z"/>
        </clipPath>

        <!-- O-shape (2x2) -->
        <clipPath id="O-shape">
            <rect width="100" height="100"/>
        </clipPath>
    </svg>

    <script>
        const TETRIS_LAYOUT = [
            { type: 'I', cols: 4, rows: 1, clip: 'I-shape' },
            { type: 'T', cols: 3, rows: 2, clip: 'T-shape' },
            { type: 'L', cols: 2, rows: 3, clip: 'L-shape' },
            { type: 'O', cols: 2, rows: 2, clip: 'O-shape' }
        ];

        const PIECES = [];
        let animationActive = true;
        let timeoutId;

        function createPuzzle() {
            const container = document.getElementById('puzzleContainer');
            let x = 0, y = 0;

            TETRIS_LAYOUT.forEach((piece, index) => {
                const div = document.createElement('div');
                div.className = 'tetris-piece';
                
                // Set dimensions and clip-path
                div.style.width = `${piece.cols * 50}px`;
                div.style.height = `${piece.rows * 50.6}px`;
                div.style.clipPath = `url(#${piece.clip})`;
                
                // Set background position
                div.style.backgroundPosition = `-${x}px -${y}px`;
                
                // Store original position
                PIECES.push({
                    element: div,
                    origX: x,
                    origY: y,
                    type: piece.type
                });

                // Update grid position
                x += piece.cols * 50;
                if(x >= 900) {
                    x = 0;
                    y += piece.rows * 50.6;
                }

                container.appendChild(div);
            });

            scramblePuzzle();
        }

        function scramblePuzzle() {
            PIECES.forEach(piece => {
                piece.element.style.transform = `
                    translate(${Math.random()*700}px, ${Math.random()*400}px)
                    rotate(${Math.random()*360}deg)
                `;
            });
        }

        function solvePuzzle() {
            PIECES.forEach(piece => {
                piece.element.style.transform = `translate(${piece.origX}px, ${piece.origY}px) rotate(0deg)`;
            });
        }

        function animatePuzzle() {
            if(!animationActive) return;
            
            solvePuzzle();
            timeoutId = setTimeout(() => {
                scramblePuzzle();
                timeoutId = setTimeout(animatePuzzle, 2000);
            }, 2000);
        }

        document.getElementById('stopBtn').addEventListener('click', () => {
            animationActive = false;
            clearTimeout(timeoutId);
        });

        window.onload = () => {
            createPuzzle();
            animatePuzzle();
        };
    </script>
</body>
</html>
